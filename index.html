<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Wenitto – Toptan Sipariş</title>
<style>
:root{--bg:#f7fafc;--panel:#fff;--border:#e5e7eb;--muted:#64748b;--text:#0f172a;
      --brand:#0ea5e9;--brand2:#22d3ee;--shadow:0 10px 30px rgba(2,8,23,.06)}
*{box-sizing:border-box} body{margin:0;background:var(--bg);color:var(--text);font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
a{color:inherit} img{display:block;max-width:100%}
header{position:sticky;top:0;z-index:30;background:#ffffffd9;backdrop-filter:saturate(180%) blur(10px);border-bottom:1px solid var(--border)}
.wrap{max-width:1200px;margin:0 auto;padding:14px 16px}
.flex{display:flex;gap:12px;align-items:center}.grow{flex:1}.logo img{height:40px}
.btn{border:0;border-radius:12px;padding:10px 14px;cursor:pointer;font-weight:700}
.btn.primary{background:linear-gradient(135deg,var(--brand),var(--brand2));color:#fff}
.btn.ghost{background:#fff;border:1px solid var(--border)}
.tabs{display:flex;gap:8px;flex-wrap:wrap;margin:10px 0 16px}
.tab{border:1px solid var(--border);background:#fff;border-radius:999px;padding:8px 14px;font-weight:700;cursor:pointer}
.tab.active{background:linear-gradient(135deg,var(--brand),var(--brand2));color:#fff;border-color:transparent}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:18px}
.card{background:var(--panel);border:1px solid var(--border);border-radius:16px;overflow:hidden;box-shadow:var(--shadow);display:flex;flex-direction:column}
.thumb{height:340px;background:#eef6ff;display:flex;align-items:center;justify-content:center;overflow:hidden}
.thumb img{height:100%;object-fit:cover}
.pad{padding:12px}.title{font-weight:800}.muted{color:var(--muted)}
.small{font-size:12px;color:var(--muted)}
.btn.block{width:100%}

/* Drawer */
.drawer{position:fixed;right:16px;bottom:16px;width:min(460px,92vw);background:#fff;border:1px solid var(--border);border-radius:16px;overflow:hidden;box-shadow:var(--shadow)}
.drawer header{display:flex;gap:10px;align-items:center;padding:10px;border-bottom:1px solid var(--border)}
.line{display:flex;align-items:start;justify-content:space-between;gap:8px;border-top:1px dashed var(--border);padding:10px 12px}

/* Modal */
dialog{border:1px solid var(--border);border-radius:16px;padding:0;background:#fff;max-width:min(1000px,96vw);box-shadow:var(--shadow)}
dialog::backdrop{background:rgba(2,8,23,.35)}
.modal-head{display:flex;gap:12px;align-items:center;padding:12px;border-bottom:1px solid var(--border)}
.modal-body{display:grid;grid-template-columns:1.1fr 1fr}
@media(max-width:840px){.modal-body{grid-template-columns:1fr}}
.left{min-height:420px}.left img{width:100%;height:100%;object-fit:cover}
.kv{display:grid;grid-template-columns:120px 1fr;gap:8px 12px;padding:12px;font-size:14px}
.blockbox{margin:12px;padding:12px;border:1px solid var(--border);border-radius:12px;background:#f8fafc}
.pills{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}
.pill{background:#fff;border:1px solid var(--border);border-radius:10px;padding:10px;text-align:center}
.stockok{color:#065f46;font-weight:700}.stockzero{color:#b91c1c;font-weight:700}
.swatches{display:flex;gap:6px;flex-wrap:wrap;padding:0 12px 12px}
.sw{border:1px solid var(--border);background:#fff;border-radius:999px;padding:6px 10px;font-size:12px;cursor:pointer}
.sw.active{background:linear-gradient(135deg,var(--brand),var(--brand2));color:#fff;border-color:transparent}
</style>
</head>
<body>
<header>
  <div class="wrap flex">
    <div class="logo"><img src="wenitto-logo.png" alt="Wenitto"></div>
    <div class="grow"></div>
    <button id="btnOpenOrder" class="btn ghost">Sipariş Özeti</button>
  </div>
</header>

<main class="wrap" style="padding:18px 16px 120px">
  <nav id="tabs" class="tabs"></nav>
  <div id="grid" class="grid"></div>
</main>

<!-- Drawer -->
<section id="drawer" class="drawer" hidden>
  <header><b>Sipariş Özeti</b><div class="grow"></div><button id="btnCloseOrder" class="btn ghost">Kapat</button></header>
  <div id="orderLines"></div>
  <div class="line"><div class="muted">Toplam Seri</div><div id="totalSeries" style="font-weight:800">0</div></div>
  <div class="line"><div class="muted">Toplam Adet</div><div id="totalQty" style="font-weight:800">0</div></div>
  <div class="line">
    <button id="btnClear" class="btn ghost">Temizle</button>
    <button id="btnWhatsApp" class="btn primary" style="flex:1">WhatsApp Sipariş</button>
  </div>
</section>

<!-- Modal -->
<dialog id="modal">
  <div class="modal-head">
    <div id="mTitle" style="font-weight:800"></div>
    <div class="grow"></div>
    <button id="mClose" class="btn ghost">Kapat</button>
  </div>

  <!-- renk swatch -->
  <div id="variantRow" class="swatches" hidden></div>

  <div class="modal-body">
    <div class="left"><img id="mImg" alt=""></div>
    <div class="right">
      <div class="kv">
        <div>Ürün Kodu</div><div id="mSku" class="muted"></div>
        <div>Renk</div><div id="mColor" class="muted"></div>
        <div>Kategori</div><div id="mCat" class="muted"></div>
        <div>Beden Seti</div><div id="mSizeSet" class="muted"></div>
      </div>

      <div class="blockbox">
        <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap">
          <div>Depo: <span id="mStockText" class="stockok"></span></div>
          <div class="muted">|</div>
          <div><b>Kaç Seri?</b> <input id="seriesCount" type="number" min="1" value="1" style="width:90px;padding:8px;border:1px solid var(--border);border-radius:10px"></div>
        </div>
        <div style="margin-top:10px" class="pills" id="pillGrid"></div>
        <small class="muted">Tam seri zorunlu: 1 seri = listelenen bedenlerin her birinden 1 adet.</small>
        <div style="margin-top:10px">
          <button id="mAdd" class="btn primary" style="width:100%">Seriyi Sepete Ekle</button>
        </div>
      </div>
    </div>
  </div>
</dialog>

<script>
/* ================== AYARLAR ================== */
const WHATSAPP_NUMBER = "905418955499";
const SIZE_SET = ["2XL","3XL","L","M","XL"]; // gösterim sırası
const CATEGORIES = ["Takım Elbise","Deri Ceket","Tek Ceket","Kaban","Damatlık","Ayakkabı","Gömlek","Pantolon"];
let currentCat = "Deri Ceket";

/* ============== VERİ YAPISI (MODEL + VARYANT + STOK) ==============
   Deri Ceket kategorisinde model bazlı (tek kart) + renk varyantlı yapı.
   stockMap: { "2XL": 7, "3XL": 7, "L": 7, "M": 7, "XL": 7 }
   Toplam SERİ = stockMap içindeki minimum değer (tam seri için her bedenden 1 gereklidir)
*/

/* ---- MODELS (renk çipli) ---- */
const MODELS = [
  /* Deri Ceket – ÖRNEK model (3 renk) */
  {
    cat:"Deri Ceket",
    model:"WN04SF053",
    name:"DERİ MONT - BİKER",
    sizes:[...SIZE_SET],
    variants:[
      { color:"Kahve",  sku:"WN04SF053-KAH",  img:"https://via.placeholder.com/600x750?text=WN04SF053-KAH",
        stockMap:{ "2XL":5, "3XL":5, "L":5, "M":5, "XL":5 } },
      { color:"Siyah",  sku:"WN04SF053-SIY",  img:"https://via.placeholder.com/600x750?text=WN04SF053-SIY",
        stockMap:{ "2XL":7, "3XL":7, "L":7, "M":7, "XL":7 } },
      { color:"Taba",   sku:"WN04SF053-TAB",  img:"https://via.placeholder.com/600x750?text=WN04SF053-TAB",
        stockMap:{ "2XL":5, "3XL":5, "L":5, "M":5, "XL":5 } },
    ]
  },

  /* Başka bir Deri Ceket modeli – örnek */
  {
    cat:"Deri Ceket",
    model:"WN05LX110",
    name:"DERİ MONT - KLASİK",
    sizes:[...SIZE_SET],
    variants:[
      { color:"Siyah",  sku:"WN05LX110-SIY", img:"https://via.placeholder.com/600x750?text=WN05LX110-SIY",
        stockMap:{ "2XL":3, "3XL":4, "L":4, "M":4, "XL":3 } },
      { color:"Kahve",  sku:"WN05LX110-KAH", img:"https://via.placeholder.com/600x750?text=WN05LX110-KAH",
        stockMap:{ "2XL":2, "3XL":2, "L":2, "M":2, "XL":2 } },
    ]
  },

  /* Diğer kategorilerde de örnek model istersek buraya ekleyebiliriz */
];

/* ---- PRODUCTS (tek renk kart) -> sadece örnek göstermek için ---- */
const PRODUCTS = [
  { cat:"Takım Elbise", sku:"WN-SUIT-001-NVY", name:"Klasik Takım – Lacivert", color:"Lacivert",
    sizes:[46,48,50,52,54,56], img:"https://images.unsplash.com/photo-1592878904946-b3cd1d0a9f28?q=80&w=1200&auto=format&fit=crop"},
  { cat:"Takım Elbise", sku:"WN-SUIT-002-GRY", name:"Modern Takım – Gri", color:"Gri",
    sizes:[46,48,50,52,54,56], img:"https://images.unsplash.com/photo-1542326237-94b1c5a5382a?q=80&w=1200&auto=format&fit=crop"},

  { cat:"Tek Ceket", sku:"WN-JKT-055-BLK", name:"Twill Ceket – Siyah", color:"Siyah",
    sizes:[46,48,50,52,54], img:"https://images.unsplash.com/photo-1520975954732-35dd222996f2?q=80&w=1200&auto=format&fit=crop"},

  { cat:"Kaban", sku:"WN-COAT-210-CAM", name:"Wool Coat – Camel", color:"Camel",
    sizes:[48,50,52,54,56], img:"https://images.unsplash.com/photo-1519741347686-c1e0d8be53ae?q=80&w=1200&auto=format&fit=crop"},

  { cat:"Damatlık", sku:"WN-TUX-001-BLK", name:"Damatlık – Siyah", color:"Siyah",
    sizes:[46,48,50,52,54], img:"https://images.unsplash.com/photo-1520975954732-35dd222996f2?q=80&w=1200&auto=format&fit=crop"},

  { cat:"Ayakkabı", sku:"WN-SHOE-001-BLK", name:"Klasik Ayakkabı", color:"Siyah",
    sizes:["40","41","42","43","44"], img:"https://images.unsplash.com/photo-1552346154-21d32810aba3?q=80&w=1200&auto=format&fit=crop"},

  { cat:"Gömlek", sku:"WN-SHIRT-001-WHT", name:"Düz Gömlek – Beyaz", color:"Beyaz",
    sizes:["S","M","L","XL","2XL"], img:"https://images.unsplash.com/photo-1541099649105-f69ad21f3246?q=80&w=1200&auto=format&fit=crop"},

  { cat:"Pantolon", sku:"WN-PANT-001-GRY", name:"Klasik Pantolon – Gri", color:"Gri",
    sizes:[46,48,50,52,54], img:"https://images.unsplash.com/photo-1548883354-bef28f394cfe?q=80&w=1200&auto=format&fit=crop"},
];

/* ================== INVENTORY ==================
   MODELS içindeki stockMap kalıcı kaynaktır.
   SERİ SAYISI = ilgili varyantın stockMap içindeki min değer.
   Sepete ekleyince stockMap[beden] -= seriSayısı (her beden için).
*/

/* ---------- UI Helpers ---------- */
const TABS=document.getElementById('tabs');
const GRID=document.getElementById('grid');
function hTabs(){
  TABS.innerHTML=CATEGORIES.map(c=>`<button class="tab ${c===currentCat?'active':''}" data-cat="${c}">${c}</button>`).join('');
}
TABS.addEventListener('click',e=>{
  const b=e.target.closest('.tab'); if(!b) return;
  currentCat=b.dataset.cat; hTabs(); renderGrid();
});

function cardForProduct(p){
  return `<article class="card">
    <div class="thumb"><img src="${p.img}" alt=""></div>
    <div class="pad">
      <div class="title">${p.name}</div>
      <div class="small">${p.sku} · ${p.color||""}</div>
      <button class="btn block primary" data-sku="${p.sku}">İncele</button>
    </div>
  </article>`;
}

function seriesFromStockMap(stockMap){
  // min değer (tam seri için her bedenden bir gerekir)
  return Math.max(0, ...[1]) && Math.min(...Object.values(stockMap||{}).map(x=>Number(x)||0));
}

function cardForModel(m){
  const totalSeries = m.variants.reduce((s,v)=> s + seriesFromStockMap(v.stockMap), 0);
  const cover = m.variants[0]?.img || "";
  return `<article class="card">
    <div class="thumb"><img src="${cover}" alt=""></div>
    <div class="pad">
      <div class="title">${m.name}</div>
      <div class="small">Toplam seri: <b>${totalSeries}</b></div>
      <button class="btn block primary" data-open-model="${m.model}">İncele</button>
    </div>
  </article>`;
}

function renderGrid(){
  const ms = MODELS.filter(x=>x.cat===currentCat);
  const ps = PRODUCTS.filter(x=>x.cat===currentCat);
  const html1 = ms.map(cardForModel).join('');
  const html2 = ps.slice(0,3).map(cardForProduct).join('');
  GRID.innerHTML = (html1 + html2) || `<div class="muted">Bu kategoride henüz ürün yok.</div>`;
}

/* ================== MODAL (ÜRÜN DETAYI) ================== */
const modal = document.getElementById('modal');
const mTitle=document.getElementById('mTitle'), mSku=document.getElementById('mSku'),
      mColor=document.getElementById('mColor'), mCat=document.getElementById('mCat'),
      mImg=document.getElementById('mImg'), mSizeSet=document.getElementById('mSizeSet'),
      mStockText=document.getElementById('mStockText'), seriesCountInput=document.getElementById('seriesCount'),
      mAdd=document.getElementById('mAdd'), mClose=document.getElementById('mClose'),
      variantRow=document.getElementById('variantRow'), pillGrid=document.getElementById('pillGrid');

let currentModel=null, currentVariantIndex=0, currentSizes=[], currentCatName="";

function openModel(m, vi=0){
  currentModel=m; currentVariantIndex=vi; currentCatName=m.cat; currentSizes=m.sizes||[];
  showVariant(vi);
  // renk çipleri
  variantRow.hidden=false;
  variantRow.innerHTML = m.variants.map((v,i)=>`<button class="sw ${i===vi?'active':''}" data-vi="${i}">${v.color}</button>`).join('');
  modal.showModal();
}

function showVariant(vi){
  currentVariantIndex=vi;
  const v = currentModel.variants[vi];
  mTitle.textContent = `${currentModel.name}`;
  mSku.textContent = v.sku; mColor.textContent = v.color; mCat.textContent=currentModel.cat;
  mImg.src = v.img;
  mSizeSet.textContent = currentModel.sizes.join(" - ");
  const seri = seriesFromStockMap(v.stockMap);
  mStockText.textContent = `${seri} seri`;
  mStockText.className = seri>0 ? 'stockok' : 'stockzero';
  seriesCountInput.value = 1;
  drawPills(v.stockMap, 0);
}

function drawPills(stockMap, req){
  // req: istenen seri
  pillGrid.innerHTML = currentSizes.map(sz=>{
    const left = (stockMap[sz]||0);
    const after = Math.max(0, left - req);
    return `<div class="pill">
      <div><b>${sz}</b></div>
      <div class="small">Kalan: <b>${left}</b></div>
      ${req>0? `<div class="small">Sonrası: <b>${after}</b></div>`:''}
    </div>`;
  }).join('');
}

variantRow.addEventListener('click',(e)=>{
  const sw=e.target.closest('.sw'); if(!sw) return;
  openModel(currentModel, Number(sw.dataset.vi));
});

seriesCountInput.addEventListener('input',()=>{
  const n = Math.max(1, parseInt(seriesCountInput.value||'1',10));
  seriesCountInput.value = n;
  const v = currentModel.variants[currentVariantIndex];
  drawPills(v.stockMap, n);
});

mClose.addEventListener('click',()=>modal.close());

GRID.addEventListener('click',(e)=>{
  const b=e.target.closest('[data-open-model]');
  if(b){
    const m = MODELS.find(x=>x.model===b.dataset.openModel);
    if(m) openModel(m,0);
    return;
  }
  const pbtn=e.target.closest('[data-sku]');
  if(pbtn){
    const p = PRODUCTS.find(x=>x.sku===pbtn.dataset.sku);
    if(p){ // tek renk ürün için minimal modal
      currentModel = {cat:p.cat, name:p.name, sizes:p.sizes, variants:[{color:p.color, sku:p.sku, img:p.img, stockMap:Object.fromEntries((p.sizes||[]).map(s=>[s,99]))}]};
      openModel(currentModel,0);
    }
  }
});

/* ================== CART & STOK DÜŞÜRME ================== */
const drawer=document.getElementById('drawer'), btnOpenOrder=document.getElementById('btnOpenOrder'),
      btnCloseOrder=document.getElementById('btnCloseOrder'), btnClear=document.getElementById('btnClear'),
      btnWhatsApp=document.getElementById('btnWhatsApp'), orderLines=document.getElementById('orderLines'),
      totalQtyEl=document.getElementById('totalQty'), totalSeriesEl=document.getElementById('totalSeries');

const CART = new Map(); // key=sku
btnOpenOrder.addEventListener('click',()=>drawer.hidden=false);
btnCloseOrder.addEventListener('click',()=>drawer.hidden=true);
btnClear.addEventListener('click',()=>{ CART.clear(); renderOrder(); });

mAdd.addEventListener('click',()=>{
  const want = Math.max(1, parseInt(seriesCountInput.value||'1',10));
  const v = currentModel.variants[currentVariantIndex];
  const seri = seriesFromStockMap(v.stockMap);
  if(want > seri){ alert(`Yetersiz seri. Mevcut: ${seri}`); return; }

  // Sepete yaz
  const key=v.sku;
  const prev=CART.get(key)||{series:0};
  CART.set(key,{ sku:v.sku, name:currentModel.name, color:v.color, cat:currentModel.cat, series:prev.series+want, sizes:[...currentModel.sizes] });

  // Stoku düşür (her bedenden want)
  currentModel.sizes.forEach(sz=>{ v.stockMap[sz] = Math.max(0, (v.stockMap[sz]||0) - want); });

  // modal bilgilerini güncelle
  showVariant(currentVariantIndex);
  renderOrder();
  drawer.hidden=false;
});

function renderOrder(){
  let html=''; let totalSeries=0, totalQty=0;
  for(const row of CART.values()){
    const qty = row.series * row.sizes.length;
    totalSeries += row.series; totalQty += qty;
    html += `<div class="line">
      <div>
        <div style="font-weight:700">${row.name} – ${row.color}</div>
        <div class="muted">${row.sku} · ${row.cat}</div>
        <div class="muted">Seri (${row.sizes.join(' / ')}): <b>${row.series}</b> → Adet: <b>${qty}</b></div>
      </div>
      <button class="btn ghost" data-del="${row.sku}">Sil</button>
    </div>`;
  }
  orderLines.innerHTML = html || `<div class="line"><div class="muted">Sepet boş.</div></div>`;
  totalQtyEl.textContent = totalQty; totalSeriesEl.textContent = totalSeries;
  renderGrid(); // kartlardaki toplam seri yenilensin
}
orderLines.addEventListener('click',(e)=>{
  const b=e.target.closest('button[data-del]'); if(!b) return;
  const row = CART.get(b.dataset.del); if(!row) return;

  // stoku iade etmek istersen:
  // ilgili modeli bul → ilgili varyant → her bedene row.series ekle
  for(const m of MODELS){
    const v = m.variants?.find(x=>x && x.sku===row.sku);
    if(v){
      m.sizes.forEach(sz=>{ v.stockMap[sz] = (v.stockMap[sz]||0) + row.series; });
      break;
    }
  }
  CART.delete(b.dataset.del);
  renderOrder();
});

btnWhatsApp.addEventListener('click',()=>{
  if(CART.size===0){ alert("Sepet boş."); return; }
  const lines=[];
  for(const row of CART.values()){
    const per = row.sizes.map(s=>`${s}: ${row.series}`).join(', ');
    lines.push(`- ${row.sku} (${row.color}) · SERİ x${row.series} [${row.sizes.join('/')}] | ${per}`);
  }
  const msg = `Wenitto Toptan Sipariş%0A%0A${lines.join('%0A')}%0A%0AToplam Seri: ${totalSeriesEl.textContent}%0AToplam Adet: ${totalQtyEl.textContent}`;
  window.open(`https://wa.me/${WHATSAPP_NUMBER}?text=${msg}`,'_blank');
});

/* ================== INIT ================== */
(function init(){
  hTabs(); renderGrid();
})();
</script>

<!-- ================== BURAYA EXCEL'DEN JSON YAPIŞTIR (İSTEĞE BAĞLI) ==================
  Şekil:
  MODELS.push({
    cat:"Deri Ceket",
    model:"WN04SF053",
    name:"DERİ MONT - BİKER",
    sizes:["2XL","3XL","L","M","XL"],
    variants:[
      { color:"Kahve", sku:"WN04SF053-KAH", img:"/img/deri/WN04SF053-KAH.jpg",
        stockMap:{ "2XL":5, "3XL":5, "L":5, "M":5, "XL":5 } },
      { color:"Siyah", sku:"WN04SF053-SIY", img:"/img/deri/WN04SF053-SIY.jpg",
        stockMap:{ "2XL":7, "3XL":7, "L":7, "M":7, "XL":7 } },
      { color:"Taba",  sku:"WN04SF053-TAB", img:"/img/deri/WN04SF053-TAB.jpg",
        stockMap:{ "2XL":5, "3XL":5, "L":5, "M":5, "XL":5 } }
    ]
  });
  Yapıştırınca sayfayı yenile; otomatik kartlara eklenecek.
============================================================================ -->
</body>
</html>


